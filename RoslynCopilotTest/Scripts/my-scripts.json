[
  {
    "Id": "http-004",
    "Name": "Check Internet Connection",
    "Description": "Verifica si hay conexi√≥n a internet y mide latencia",
    "Category": "Examples",
    "Icon": null,
    "Code": "using (var client = new HttpClient())\n{\n    var results = new System.Text.StringBuilder();\n    results.AppendLine(\"üåê Test de Conectividad\\n\");\n    \n    // Lista de URLs para probar\n    var testUrls = new[] {\n        \"https://www.google.com\",\n        \"https://api.github.com\",\n        \"https://jsonplaceholder.typicode.com\"\n    };\n    \n    foreach (var url in testUrls)\n    {\n        try\n        {\n            var startTime = DateTime.Now;\n            var response = await client.GetAsync(url);\n            var duration = (DateTime.Now - startTime).TotalMilliseconds;\n            \n            results.AppendLine($\"‚úÖ {url}\");\n            results.AppendLine($\"   Status: {response.StatusCode}\");\n            results.AppendLine($\"   Latencia: {duration:F0} ms\\n\");\n        }\n        catch (Exception ex)\n        {\n            results.AppendLine($\"‚ùå {url}\");\n            results.AppendLine($\"   Error: {ex.Message}\\n\");\n        }\n    }\n    \n    TaskDialog.Show(\"Connectivity Test\", results.ToString());\n    return \"Test completado\";\n}",
    "IsFavorite": false,
    "ShowAsButton": true,
    "CreatedDate": "2025-10-15T00:00:00",
    "LastModified": "2025-10-15T11:36:19.1892727-05:00"
  },
  {
    "Id": "contador-de-puertas-4729463024",
    "Name": "Contador de puertas",
    "Description": "cuenta puertastoche",
    "Category": "Examples",
    "Icon": "script.png",
    "Code": "// üöÄ Escribe tu c√≥digo C# aqu√≠\nint doorCount = new FilteredElementCollector(doc)\r\n    .OfClass(typeof(FamilyInstance))\r\n    .OfCategory(BuiltInCategory.OST_Doors)\r\n    .WhereElementIsNotElementType()\r\n    .ToElements()\r\n    .Count;\r\n\r\nTaskDialog.Show(\"Conteo\", $\"Puertas: {doorCount}\");",
    "IsFavorite": false,
    "ShowAsButton": true,
    "CreatedDate": "2025-10-14T09:21:12.9461421-05:00",
    "LastModified": "2025-10-14T20:44:27.6500082-05:00"
  },
  {
    "Id": "excel-001",
    "Name": "Export Rooms to Excel",
    "Description": "Exporta informaci√≥n de habitaciones a Excel (.xlsx)",
    "Category": "Examples",
    "Icon": null,
    "Code": "// Habilitar encodings legacy para Excel\nSystem.Text.Encoding.RegisterProvider(System.Text.CodePagesEncodingProvider.Instance);\n// Configurar licencia de EPPlus (NonCommercial)\nExcelPackage.LicenseContext = OfficeOpenXml.LicenseContext.NonCommercial;\n\n// Obtener todas las habitaciones\nvar rooms = new FilteredElementCollector(doc)\n    .OfClass(typeof(SpatialElement))\n    .OfCategory(BuiltInCategory.OST_Rooms)\n    .Cast<Room>()\n    .Where(r => r.Area > 0)\n    .ToList();\n\n// Crear archivo Excel\nvar desktopPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);\nvar excelPath = Path.Combine(desktopPath, $\"Rooms_{DateTime.Now:yyyyMMdd_HHmmss}.xlsx\");\n\nusing (var package = new ExcelPackage())\n{\n    var worksheet = package.Workbook.Worksheets.Add(\"Rooms\");\n    \n    // Encabezados\n    worksheet.Cells[1, 1].Value = \"ID\";\n    worksheet.Cells[1, 2].Value = \"Number\";\n    worksheet.Cells[1, 3].Value = \"Name\";\n    worksheet.Cells[1, 4].Value = \"Level\";\n    worksheet.Cells[1, 5].Value = \"Area (SF)\";\n    worksheet.Cells[1, 6].Value = \"Perimeter\";\n    worksheet.Cells[1, 7].Value = \"Department\";\n    \n    // Estilo de encabezados\n    using (var range = worksheet.Cells[1, 1, 1, 7])\n    {\n        range.Style.Font.Bold = true;\n        range.Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;\n        range.Style.Fill.BackgroundColor.SetColor(System.Drawing.Color.LightBlue);\n    }\n    \n    // Datos\n    int row = 2;\n    foreach (var room in rooms)\n    {\n        var level = doc.GetElement(room.LevelId) as Level;\n        \n        worksheet.Cells[row, 1].Value = room.Id.IntegerValue;\n        worksheet.Cells[row, 2].Value = room.Number;\n        worksheet.Cells[row, 3].Value = room.get_Parameter(BuiltInParameter.ROOM_NAME)?.AsString() ?? \"\";\n        worksheet.Cells[row, 4].Value = level?.Name ?? \"Unknown\";\n        worksheet.Cells[row, 5].Value = room.Area;\n        worksheet.Cells[row, 6].Value = room.Perimeter;\n        worksheet.Cells[row, 7].Value = room.get_Parameter(BuiltInParameter.ROOM_DEPARTMENT)?.AsString() ?? \"\";\n        \n        row++;\n    }\n    \n    // Ajustar ancho de columnas\n    worksheet.Cells.AutoFitColumns();\n    \n    // Guardar\n    package.SaveAs(new FileInfo(excelPath));\n}\n\nTaskDialog.Show(\"Excel Export\", \n    $\"‚úÖ Exported {rooms.Count} rooms\\n\\nFile: {excelPath}\");\n\nreturn $\"Exported {rooms.Count} rooms to Excel\";",
    "IsFavorite": false,
    "ShowAsButton": true,
    "CreatedDate": "2025-10-15T00:00:00",
    "LastModified": "2025-10-15T11:35:06.866722-05:00"
  },
  {
    "Id": "csv-001",
    "Name": "Export Walls to CSV",
    "Description": "Exporta informaci√≥n de muros a un archivo CSV",
    "Category": "Examples",
    "Icon": null,
    "Code": "// Obtener todos los muros\nvar walls = new FilteredElementCollector(doc)\n    .OfClass(typeof(Wall))\n    .WhereElementIsNotElementType()\n    .Cast<Wall>()\n    .ToList();\n\n// Crear archivo CSV en el escritorio\nvar desktopPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);\nvar csvPath = Path.Combine(desktopPath, $\"Walls_{DateTime.Now:yyyyMMdd_HHmmss}.csv\");\n\nusing (var writer = new StreamWriter(csvPath, false, Encoding.UTF8))\n{\n    // Escribir encabezados\n    writer.WriteLine(\"ID,Name,Type,Height,Length,Area,Level\");\n    \n    // Escribir datos de cada muro\n    foreach (var wall in walls)\n    {\n        var wallType = doc.GetElement(wall.GetTypeId()) as WallType;\n        var level = doc.GetElement(wall.LevelId) as Level;\n        \n        var height = wall.get_Parameter(BuiltInParameter.WALL_USER_HEIGHT_PARAM)?.AsDouble() ?? 0;\n        var area = wall.get_Parameter(BuiltInParameter.HOST_AREA_COMPUTED)?.AsDouble() ?? 0;\n        \n        writer.WriteLine($\"{wall.Id.IntegerValue},\" +\n                        $\"\\\"{wall.Name}\\\",\" +\n                        $\"\\\"{wallType?.Name ?? \"Unknown\"}\\\",\" +\n                        $\"{height:F2},\" +\n                        $\"{wall.Width:F2},\" +\n                        $\"{area:F2},\" +\n                        $\"\\\"{level?.Name ?? \"Unknown\"}\\\"\");\n    }\n}\n\nTaskDialog.Show(\"CSV Export\", \n    $\"‚úÖ Exported {walls.Count} walls\\n\\nFile: {csvPath}\");\n\nreturn $\"Exported {walls.Count} walls to CSV\";",
    "IsFavorite": false,
    "ShowAsButton": true,
    "CreatedDate": "2025-10-15T00:00:00",
    "LastModified": "2025-10-15T11:35:06.8667182-05:00"
  },
  {
    "Id": "info-proyecto-inicial",
    "Name": "Informaci√≥n del Proyecto",
    "Description": "Muestra informaci√≥n b√°sica del proyecto actual",
    "Category": "Examples",
    "Icon": null,
    "Code": "try\r\n{\r\n    var sb = new System.Text.StringBuilder();\r\n    sb.AppendLine($\"üìÇ Proyecto: {doc.Title}\");\r\n    sb.AppendLine($\"üìç Ruta: {doc.PathName}\");\r\n    sb.AppendLine($\"üîß Revit: {app.VersionName}\");\r\n    sb.AppendLine($\"üìÖ Fecha: {DateTime.Now:dd/MM/yyyy HH:mm}\");\r\n    return sb.ToString();\r\n}\r\ncatch (Exception ex)\r\n{\r\n    return $\"‚ùå Error: {ex.Message}\";\r\n}",
    "IsFavorite": false,
    "ShowAsButton": true,
    "CreatedDate": "2025-10-14T17:20:05.0171284-05:00",
    "LastModified": "2025-10-14T17:20:05.0171285-05:00"
  },
  {
    "Id": "ventana-grande-1671501172",
    "Name": "Ventana Grande",
    "Description": "Selecciona la ventana mas grande",
    "Category": "Examples",
    "Icon": "script.png",
    "Code": "// üöÄ Escribe tu c√≥digo C# aqu√≠\n// 1. USINGS REQUERIDOS\r\nusing Autodesk.Revit.DB;\r\nusing Autodesk.Revit.UI;\r\nusing System;\r\nusing System.Linq;\r\nusing System.Collections.Generic;\r\n\r\n// 2. C√ìDIGO DENTRO DEL TRY-CATCH\r\ntry\r\n{\r\n    // Funci√≥n auxiliar para buscar un par√°metro por varios nombres\r\n    Parameter FindParameter(Element elem, List<string> names)\r\n    {\r\n        foreach (var name in names)\r\n        {\r\n            Parameter p = elem.LookupParameter(name);\r\n            if (p != null && p.HasValue) return p;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    // Recolectar todas las instancias de ventanas en el documento\r\n    var windows = new FilteredElementCollector(doc)\r\n        .OfCategory(BuiltInCategory.OST_Windows)\r\n        .OfClass(typeof(FamilyInstance))\r\n        .Cast<FamilyInstance>()\r\n        .ToList();\r\n\r\n    if (!windows.Any())\r\n    {\r\n        TaskDialog.Show(\"Informaci√≥n\", \"No se encontraron ventanas en el proyecto.\");\r\n        return \"‚ö†Ô∏è No se encontraron ventanas para analizar.\";\r\n    }\r\n\r\n    FamilyInstance largestWindow = null;\r\n    double maxArea = 0.0;\r\n    \r\n    // Listas de posibles nombres para los par√°metros\r\n    var widthNames = new List<string> { \"Ancho\", \"Width\" };\r\n    var heightNames = new List<string> { \"Alto\", \"Height\", \"Altura\" };\r\n\r\n    foreach (var window in windows)\r\n    {\r\n        Parameter widthParam = null;\r\n        Parameter heightParam = null;\r\n        \r\n        // 1. Buscar par√°metros de sistema (BuiltIn) en la instancia\r\n        widthParam = window.get_Parameter(BuiltInParameter.FAMILY_WIDTH_PARAM);\r\n        heightParam = window.get_Parameter(BuiltInParameter.FAMILY_HEIGHT_PARAM);\r\n\r\n        // Obtener el tipo de la ventana para b√∫squedas posteriores\r\n        FamilySymbol windowType = doc.GetElement(window.GetTypeId()) as FamilySymbol;\r\n\r\n        // 2. Si no se encuentran, buscar en el tipo (BuiltIn)\r\n        if (windowType != null && (widthParam == null || heightParam == null || !widthParam.HasValue))\r\n        {\r\n            widthParam = windowType.get_Parameter(BuiltInParameter.FAMILY_WIDTH_PARAM) ?? widthParam;\r\n            heightParam = windowType.get_Parameter(BuiltInParameter.FAMILY_HEIGHT_PARAM) ?? heightParam;\r\n        }\r\n\r\n        // 3. Si a√∫n no se encuentran, buscar por nombre en la instancia\r\n        if (widthParam == null || !widthParam.HasValue) widthParam = FindParameter(window, widthNames);\r\n        if (heightParam == null || !heightParam.HasValue) heightParam = FindParameter(window, heightNames);\r\n\r\n        // 4. Como √∫ltimo recurso, buscar por nombre en el tipo\r\n        if (windowType != null && (widthParam == null || !widthParam.HasValue))\r\n        {\r\n            widthParam = FindParameter(windowType, widthNames);\r\n        }\r\n        if (windowType != null && (heightParam == null || !heightParam.HasValue))\r\n        {\r\n            heightParam = FindParameter(windowType, heightNames);\r\n        }\r\n\r\n        // Si se encontraron ambos par√°metros, calcular el √°rea\r\n        if (widthParam != null && heightParam != null && widthParam.HasValue && heightParam.HasValue)\r\n        {\r\n            double width = widthParam.AsDouble();\r\n            double height = heightParam.AsDouble();\r\n            double currentArea = width * height;\r\n\r\n            if (currentArea > maxArea)\r\n            {\r\n                maxArea = currentArea;\r\n                largestWindow = window;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (largestWindow == null)\r\n    {\r\n        TaskDialog.Show(\"Error\", \"No se pudo determinar el tama√±o de ninguna ventana. Es probable que usen nombres de par√°metros muy espec√≠ficos. Por favor, revisa una familia de ventana manualmente.\");\r\n        return \"‚ùå No se pudo calcular el √°rea de las ventanas. Los par√°metros no son est√°ndar.\";\r\n    }\r\n\r\n    // 3. MOSTRAR RESULTADO\r\n    TaskDialog.Show(\"Ventana m√°s Grande\", $\"La ventana con el √°rea m√°s grande tiene el ID: {largestWindow.Id.IntegerValue}\");\r\n\r\n    // 4. RETURN OBLIGATORIO\r\n    return $\"‚úÖ Proceso completado. La ventana m√°s grande es la ID {largestWindow.Id.IntegerValue}.\";\r\n}\r\ncatch (Exception ex)\r\n{\r\n    // Manejo de errores inesperados\r\n    TaskDialog.Show(\"Error\", $\"Ocurri√≥ un error inesperado: {ex.Message}\");\r\n    return $\"‚ùå Error: {ex.Message}\";\r\n}",
    "IsFavorite": false,
    "ShowAsButton": true,
    "CreatedDate": "2025-10-15T14:09:27.1499749-05:00",
    "LastModified": "2025-10-15T14:09:27.1499749-05:00"
  }
]