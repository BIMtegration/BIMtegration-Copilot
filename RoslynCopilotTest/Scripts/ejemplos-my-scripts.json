{
  "ExportDate": "2025-10-15T12:49:25.0359869-05:00",
  "Version": "1.0",
  "TotalScripts": 17,
  "ExportType": "Complete",
  "Scripts": [
    {
      "Id": "http-004",
      "Name": "Check Internet Connection",
      "Description": "Verifica si hay conexión a internet y mide latencia",
      "Category": "🌐 HTTP Examples",
      "Icon": null,
      "Code": "using (var client = new HttpClient())\n{\n    var results = new System.Text.StringBuilder();\n    results.AppendLine(\"🌐 Test de Conectividad\\n\");\n    \n    // Lista de URLs para probar\n    var testUrls = new[] {\n        \"https://www.google.com\",\n        \"https://api.github.com\",\n        \"https://jsonplaceholder.typicode.com\"\n    };\n    \n    foreach (var url in testUrls)\n    {\n        try\n        {\n            var startTime = DateTime.Now;\n            var response = await client.GetAsync(url);\n            var duration = (DateTime.Now - startTime).TotalMilliseconds;\n            \n            results.AppendLine($\"✅ {url}\");\n            results.AppendLine($\"   Status: {response.StatusCode}\");\n            results.AppendLine($\"   Latencia: {duration:F0} ms\\n\");\n        }\n        catch (Exception ex)\n        {\n            results.AppendLine($\"❌ {url}\");\n            results.AppendLine($\"   Error: {ex.Message}\\n\");\n        }\n    }\n    \n    TaskDialog.Show(\"Connectivity Test\", results.ToString());\n    return \"Test completado\";\n}",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:36:19.1892727-05:00"
    },
    {
      "Id": "http-002",
      "Name": "Get User Info from API",
      "Description": "Obtiene información de usuario desde una API y la procesa",
      "Category": "🌐 HTTP Examples",
      "Icon": null,
      "Code": "using (var client = new HttpClient())\n{\n    try\n    {\n        // Configurar headers\n        client.DefaultRequestHeaders.Add(\"User-Agent\", \"BIMtegration-Copilot\");\n        \n        string url = \"https://api.github.com/users/github\";\n        string jsonResponse = await client.GetStringAsync(url);\n        \n        // Parsear JSON básico (sin Newtonsoft aquí, solo demo)\n        var lines = jsonResponse.Split(',');\n        var summary = string.Join(\"\\n\", lines.Take(5));\n        \n        TaskDialog.Show(\"User Info\", \"Primeras 5 líneas:\\n\\n\" + summary);\n        return \"✅ Usuario obtenido\";\n    }\n    catch (Exception ex)\n    {\n        return \"❌ Error: \" + ex.Message;\n    }\n}",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:36:19.1892695-05:00"
    },
    {
      "Id": "http-003",
      "Name": "POST Request Example",
      "Description": "Envía datos a una API usando POST",
      "Category": "🌐 HTTP Examples",
      "Icon": null,
      "Code": "using (var client = new HttpClient())\n{\n    try\n    {\n        string url = \"https://jsonplaceholder.typicode.com/posts\";\n        \n        // Crear contenido JSON para enviar\n        var jsonContent = new StringContent(\n            \"{\\\"title\\\":\\\"Test from Revit\\\",\\\"body\\\":\\\"Posted from BIMtegration Copilot\\\",\\\"userId\\\":1}\",\n            System.Text.Encoding.UTF8,\n            \"application/json\"\n        );\n        \n        var response = await client.PostAsync(url, jsonContent);\n        string responseBody = await response.Content.ReadAsStringAsync();\n        \n        TaskDialog.Show(\"POST Response\", \n            $\"Status: {response.StatusCode}\\n\\nResponse:\\n{responseBody}\");\n        \n        return response.IsSuccessStatusCode ? \"✅ POST exitoso\" : \"⚠️ POST con errores\";\n    }\n    catch (Exception ex)\n    {\n        return \"❌ Error: \" + ex.Message;\n    }\n}",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:36:19.189272-05:00"
    },
    {
      "Id": "http-005",
      "Name": "Revit + API Integration",
      "Description": "Combina datos de Revit con una API externa (ejemplo avanzado)",
      "Category": "🌐 HTTP Examples",
      "Icon": null,
      "Code": "// Obtener información del proyecto actual\nvar projectName = doc.ProjectInformation.Name ?? \"Sin nombre\";\nvar wallCount = new FilteredElementCollector(doc)\n    .OfClass(typeof(Wall))\n    .WhereElementIsNotElementType()\n    .Count();\n\n// Simular envío de datos a una API\nusing (var client = new HttpClient())\n{\n    try\n    {\n        string url = \"https://jsonplaceholder.typicode.com/posts\";\n        \n        // Crear payload con datos del proyecto\n        var payload = $@\"{{\n            \"\"title\"\": \"\"Revit Project Report\"\",\n            \"\"body\"\": \"\"Project: {projectName}, Walls: {wallCount}\"\",\n            \"\"userId\"\": 1\n        }}\";\n        \n        var content = new StringContent(payload, \n            System.Text.Encoding.UTF8, \n            \"application/json\");\n        \n        var response = await client.PostAsync(url, content);\n        var responseBody = await response.Content.ReadAsStringAsync();\n        \n        TaskDialog.Show(\"Project Data Sent\", \n            $\"📊 Datos del Proyecto:\\n\" +\n            $\"Nombre: {projectName}\\n\" +\n            $\"Muros: {wallCount}\\n\\n\" +\n            $\"🌐 Respuesta API:\\n{responseBody}\");\n        \n        return $\"✅ Datos enviados: {wallCount} muros\";\n    }\n    catch (Exception ex)\n    {\n        return \"❌ Error: \" + ex.Message;\n    }\n}",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:36:19.1892734-05:00"
    },
    {
      "Id": "http-001",
      "Name": "Test API Connection (Simple)",
      "Description": "Hace una petición GET simple a una API pública y muestra el resultado",
      "Category": "🌐 HTTP Examples",
      "Icon": null,
      "Code": "using (var client = new HttpClient())\n{\n    try\n    {\n        string url = \"https://jsonplaceholder.typicode.com/todos/1\";\n        string response = await client.GetStringAsync(url);\n        TaskDialog.Show(\"API Response\", response);\n        return \"✅ Petición exitosa\";\n    }\n    catch (Exception ex)\n    {\n        TaskDialog.Show(\"Error\", ex.Message);\n        return \"❌ Error: \" + ex.Message;\n    }\n}",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:36:19.1892677-05:00"
    },
    {
      "Id": "csv-003",
      "Name": "Export Doors to CSV (CsvHelper)",
      "Description": "Exporta puertas usando CsvHelper (más robusto)",
      "Category": "📊 CSV/Excel",
      "Icon": null,
      "Code": "// Obtener todas las puertas\nvar doors = new FilteredElementCollector(doc)\n    .OfClass(typeof(FamilyInstance))\n    .OfCategory(BuiltInCategory.OST_Doors)\n    .WhereElementIsNotElementType()\n    .Cast<FamilyInstance>()\n    .ToList();\n\n// Clase para datos de puerta\nvar doorData = doors.Select(door => new\n{\n    ID = door.Id.IntegerValue,\n    Mark = door.get_Parameter(BuiltInParameter.ALL_MODEL_MARK)?.AsString() ?? \"\",\n    Family = door.Symbol.FamilyName,\n    Type = door.Symbol.Name,\n    Level = (doc.GetElement(door.LevelId) as Level)?.Name ?? \"Unknown\",\n    Width = door.Symbol.get_Parameter(BuiltInParameter.DOOR_WIDTH)?.AsDouble() ?? 0,\n    Height = door.Symbol.get_Parameter(BuiltInParameter.DOOR_HEIGHT)?.AsDouble() ?? 0\n}).ToList();\n\n// Crear archivo CSV\nvar desktopPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);\nvar csvPath = Path.Combine(desktopPath, $\"Doors_{DateTime.Now:yyyyMMdd_HHmmss}.csv\");\n\nusing (var writer = new StreamWriter(csvPath, false, Encoding.UTF8))\nusing (var csv = new CsvHelper.CsvWriter(writer, System.Globalization.CultureInfo.InvariantCulture))\n{\n    csv.WriteRecords(doorData);\n}\n\nTaskDialog.Show(\"CSV Export\", \n    $\"✅ Exported {doors.Count} doors\\n\\nFile: {csvPath}\");\n\nreturn $\"Exported {doors.Count} doors to CSV\";",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:35:06.8667214-05:00"
    },
    {
      "Id": "excel-003",
      "Name": "Export Elements Summary to Excel",
      "Description": "Crea un resumen completo de elementos del proyecto en Excel",
      "Category": "📊 CSV/Excel",
      "Icon": null,
      "Code": "// Habilitar encodings legacy para Excel\nSystem.Text.Encoding.RegisterProvider(System.Text.CodePagesEncodingProvider.Instance);\n// Configurar licencia\nExcelPackage.LicenseContext = OfficeOpenXml.LicenseContext.NonCommercial;\n\n// Contar elementos por categoría\nvar wallsCount = new FilteredElementCollector(doc).OfClass(typeof(Wall)).WhereElementIsNotElementType().Count();\nvar doorsCount = new FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Doors).WhereElementIsNotElementType().Count();\nvar windowsCount = new FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Windows).WhereElementIsNotElementType().Count();\nvar roomsCount = new FilteredElementCollector(doc).OfCategory(BuiltInCategory.OST_Rooms).Count();\n\n// Crear Excel\nvar desktopPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);\nvar excelPath = Path.Combine(desktopPath, $\"ProjectSummary_{DateTime.Now:yyyyMMdd_HHmmss}.xlsx\");\n\nusing (var package = new ExcelPackage())\n{\n    // Hoja 1: Resumen\n    var summarySheet = package.Workbook.Worksheets.Add(\"Summary\");\n    summarySheet.Cells[1, 1].Value = \"Project Summary\";\n    summarySheet.Cells[1, 1].Style.Font.Size = 16;\n    summarySheet.Cells[1, 1].Style.Font.Bold = true;\n    \n    summarySheet.Cells[3, 1].Value = \"Project Name:\";\n    summarySheet.Cells[3, 2].Value = doc.Title;\n    summarySheet.Cells[4, 1].Value = \"Generated:\";\n    summarySheet.Cells[4, 2].Value = DateTime.Now.ToString(\"yyyy-MM-dd HH:mm:ss\");\n    \n    summarySheet.Cells[6, 1].Value = \"Element Type\";\n    summarySheet.Cells[6, 2].Value = \"Count\";\n    summarySheet.Cells[6, 1, 6, 2].Style.Font.Bold = true;\n    \n    summarySheet.Cells[7, 1].Value = \"Walls\";\n    summarySheet.Cells[7, 2].Value = wallsCount;\n    summarySheet.Cells[8, 1].Value = \"Doors\";\n    summarySheet.Cells[8, 2].Value = doorsCount;\n    summarySheet.Cells[9, 1].Value = \"Windows\";\n    summarySheet.Cells[9, 2].Value = windowsCount;\n    summarySheet.Cells[10, 1].Value = \"Rooms\";\n    summarySheet.Cells[10, 2].Value = roomsCount;\n    \n    summarySheet.Cells.AutoFitColumns();\n    \n    // Hoja 2: Walls\n    var wallsSheet = package.Workbook.Worksheets.Add(\"Walls\");\n    var walls = new FilteredElementCollector(doc).OfClass(typeof(Wall)).WhereElementIsNotElementType().Cast<Wall>().Take(100).ToList();\n    \n    wallsSheet.Cells[1, 1].Value = \"ID\";\n    wallsSheet.Cells[1, 2].Value = \"Type\";\n    wallsSheet.Cells[1, 3].Value = \"Height\";\n    wallsSheet.Cells[1, 4].Value = \"Area\";\n    \n    int row = 2;\n    foreach (var wall in walls)\n    {\n        var wallType = doc.GetElement(wall.GetTypeId());\n        wallsSheet.Cells[row, 1].Value = wall.Id.IntegerValue;\n        wallsSheet.Cells[row, 2].Value = wallType?.Name ?? \"Unknown\";\n        wallsSheet.Cells[row, 3].Value = wall.get_Parameter(BuiltInParameter.WALL_USER_HEIGHT_PARAM)?.AsDouble() ?? 0;\n        wallsSheet.Cells[row, 4].Value = wall.get_Parameter(BuiltInParameter.HOST_AREA_COMPUTED)?.AsDouble() ?? 0;\n        row++;\n    }\n    wallsSheet.Cells.AutoFitColumns();\n    \n    // Guardar\n    package.SaveAs(new FileInfo(excelPath));\n}\n\nTaskDialog.Show(\"Excel Export\", \n    $\"✅ Project summary exported\\n\\n\" +\n    $\"Walls: {wallsCount}\\n\" +\n    $\"Doors: {doorsCount}\\n\" +\n    $\"Windows: {windowsCount}\\n\" +\n    $\"Rooms: {roomsCount}\\n\\n\" +\n    $\"File: {excelPath}\");\n\nreturn \"Project summary exported\";",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:35:06.8667233-05:00"
    },
    {
      "Id": "excel-001",
      "Name": "Export Rooms to Excel",
      "Description": "Exporta información de habitaciones a Excel (.xlsx)",
      "Category": "📊 CSV/Excel",
      "Icon": null,
      "Code": "// Habilitar encodings legacy para Excel\nSystem.Text.Encoding.RegisterProvider(System.Text.CodePagesEncodingProvider.Instance);\n// Configurar licencia de EPPlus (NonCommercial)\nExcelPackage.LicenseContext = OfficeOpenXml.LicenseContext.NonCommercial;\n\n// Obtener todas las habitaciones\nvar rooms = new FilteredElementCollector(doc)\n    .OfClass(typeof(SpatialElement))\n    .OfCategory(BuiltInCategory.OST_Rooms)\n    .Cast<Room>()\n    .Where(r => r.Area > 0)\n    .ToList();\n\n// Crear archivo Excel\nvar desktopPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);\nvar excelPath = Path.Combine(desktopPath, $\"Rooms_{DateTime.Now:yyyyMMdd_HHmmss}.xlsx\");\n\nusing (var package = new ExcelPackage())\n{\n    var worksheet = package.Workbook.Worksheets.Add(\"Rooms\");\n    \n    // Encabezados\n    worksheet.Cells[1, 1].Value = \"ID\";\n    worksheet.Cells[1, 2].Value = \"Number\";\n    worksheet.Cells[1, 3].Value = \"Name\";\n    worksheet.Cells[1, 4].Value = \"Level\";\n    worksheet.Cells[1, 5].Value = \"Area (SF)\";\n    worksheet.Cells[1, 6].Value = \"Perimeter\";\n    worksheet.Cells[1, 7].Value = \"Department\";\n    \n    // Estilo de encabezados\n    using (var range = worksheet.Cells[1, 1, 1, 7])\n    {\n        range.Style.Font.Bold = true;\n        range.Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;\n        range.Style.Fill.BackgroundColor.SetColor(System.Drawing.Color.LightBlue);\n    }\n    \n    // Datos\n    int row = 2;\n    foreach (var room in rooms)\n    {\n        var level = doc.GetElement(room.LevelId) as Level;\n        \n        worksheet.Cells[row, 1].Value = room.Id.IntegerValue;\n        worksheet.Cells[row, 2].Value = room.Number;\n        worksheet.Cells[row, 3].Value = room.get_Parameter(BuiltInParameter.ROOM_NAME)?.AsString() ?? \"\";\n        worksheet.Cells[row, 4].Value = level?.Name ?? \"Unknown\";\n        worksheet.Cells[row, 5].Value = room.Area;\n        worksheet.Cells[row, 6].Value = room.Perimeter;\n        worksheet.Cells[row, 7].Value = room.get_Parameter(BuiltInParameter.ROOM_DEPARTMENT)?.AsString() ?? \"\";\n        \n        row++;\n    }\n    \n    // Ajustar ancho de columnas\n    worksheet.Cells.AutoFitColumns();\n    \n    // Guardar\n    package.SaveAs(new FileInfo(excelPath));\n}\n\nTaskDialog.Show(\"Excel Export\", \n    $\"✅ Exported {rooms.Count} rooms\\n\\nFile: {excelPath}\");\n\nreturn $\"Exported {rooms.Count} rooms to Excel\";",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:35:06.866722-05:00"
    },
    {
      "Id": "hybrid-001",
      "Name": "Export to CSV and Upload to API",
      "Description": "Exporta datos a CSV y los sube a una API (combina CSV + HTTP)",
      "Category": "📊 CSV/Excel",
      "Icon": null,
      "Code": "// 1. Obtener muros\nvar walls = new FilteredElementCollector(doc)\n    .OfClass(typeof(Wall))\n    .WhereElementIsNotElementType()\n    .Cast<Wall>()\n    .Take(10)\n    .ToList();\n\n// 2. Crear CSV en memoria\nvar csvContent = new System.Text.StringBuilder();\ncsvContent.AppendLine(\"ID,Type,Height,Area\");\n\nforeach (var wall in walls)\n{\n    var wallType = doc.GetElement(wall.GetTypeId());\n    var height = wall.get_Parameter(BuiltInParameter.WALL_USER_HEIGHT_PARAM)?.AsDouble() ?? 0;\n    var area = wall.get_Parameter(BuiltInParameter.HOST_AREA_COMPUTED)?.AsDouble() ?? 0;\n    \n    csvContent.AppendLine($\"{wall.Id.IntegerValue},\" +\n                         $\"{wallType?.Name ?? \"Unknown\"},\" +\n                         $\"{height:F2},\" +\n                         $\"{area:F2}\");\n}\n\n// 3. Guardar CSV localmente\nvar desktopPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);\nvar csvPath = Path.Combine(desktopPath, $\"Walls_{DateTime.Now:yyyyMMdd_HHmmss}.csv\");\nFile.WriteAllText(csvPath, csvContent.ToString(), Encoding.UTF8);\n\n// 4. Subir a API (ejemplo)\nusing (var client = new HttpClient())\n{\n    try\n    {\n        // Convertir CSV a JSON para enviar\n        var jsonData = new\n        {\n            project = doc.Title,\n            timestamp = DateTime.Now.ToString(\"o\"),\n            wallCount = walls.Count,\n            csvData = csvContent.ToString()\n        };\n        \n        var json = Newtonsoft.Json.JsonConvert.SerializeObject(jsonData);\n        var content = new StringContent(json, Encoding.UTF8, \"application/json\");\n        \n        // Enviar a API de prueba\n        var response = await client.PostAsync(\n            \"https://jsonplaceholder.typicode.com/posts\", \n            content);\n        \n        var responseBody = await response.Content.ReadAsStringAsync();\n        \n        TaskDialog.Show(\"CSV Export + Upload\", \n            $\"✅ Local CSV: {csvPath}\\n\\n\" +\n            $\"✅ Uploaded to API\\n\" +\n            $\"Status: {response.StatusCode}\\n\\n\" +\n            $\"Walls exported: {walls.Count}\");\n        \n        return \"CSV created and uploaded successfully\";\n    }\n    catch (Exception ex)\n    {\n        TaskDialog.Show(\"Error\", $\"CSV saved locally but upload failed:\\n{ex.Message}\");\n        return \"CSV saved, upload failed\";\n    }\n}",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:35:06.8667243-05:00"
    },
    {
      "Id": "csv-001",
      "Name": "Export Walls to CSV",
      "Description": "Exporta información de muros a un archivo CSV",
      "Category": "📊 CSV/Excel",
      "Icon": null,
      "Code": "// Obtener todos los muros\nvar walls = new FilteredElementCollector(doc)\n    .OfClass(typeof(Wall))\n    .WhereElementIsNotElementType()\n    .Cast<Wall>()\n    .ToList();\n\n// Crear archivo CSV en el escritorio\nvar desktopPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);\nvar csvPath = Path.Combine(desktopPath, $\"Walls_{DateTime.Now:yyyyMMdd_HHmmss}.csv\");\n\nusing (var writer = new StreamWriter(csvPath, false, Encoding.UTF8))\n{\n    // Escribir encabezados\n    writer.WriteLine(\"ID,Name,Type,Height,Length,Area,Level\");\n    \n    // Escribir datos de cada muro\n    foreach (var wall in walls)\n    {\n        var wallType = doc.GetElement(wall.GetTypeId()) as WallType;\n        var level = doc.GetElement(wall.LevelId) as Level;\n        \n        var height = wall.get_Parameter(BuiltInParameter.WALL_USER_HEIGHT_PARAM)?.AsDouble() ?? 0;\n        var area = wall.get_Parameter(BuiltInParameter.HOST_AREA_COMPUTED)?.AsDouble() ?? 0;\n        \n        writer.WriteLine($\"{wall.Id.IntegerValue},\" +\n                        $\"\\\"{wall.Name}\\\",\" +\n                        $\"\\\"{wallType?.Name ?? \"Unknown\"}\\\",\" +\n                        $\"{height:F2},\" +\n                        $\"{wall.Width:F2},\" +\n                        $\"{area:F2},\" +\n                        $\"\\\"{level?.Name ?? \"Unknown\"}\\\"\");\n    }\n}\n\nTaskDialog.Show(\"CSV Export\", \n    $\"✅ Exported {walls.Count} walls\\n\\nFile: {csvPath}\");\n\nreturn $\"Exported {walls.Count} walls to CSV\";",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:35:06.8667182-05:00"
    },
    {
      "Id": "excel-004",
      "Name": "Import Data from Excel",
      "Description": "Lee datos de Excel y los muestra (ejemplo de importación)",
      "Category": "📊 CSV/Excel",
      "Icon": null,
      "Code": "// Habilitar encodings legacy para Excel\nSystem.Text.Encoding.RegisterProvider(System.Text.CodePagesEncodingProvider.Instance);\n// Configurar licencia\nExcelPackage.LicenseContext = OfficeOpenXml.LicenseContext.NonCommercial;\n\n// Seleccionar archivo\nvar openDialog = new Microsoft.Win32.OpenFileDialog\n{\n    Title = \"Select Excel File to Import\",\n    Filter = \"Excel Files (*.xlsx)|*.xlsx\",\n    DefaultExt = \"xlsx\"\n};\n\nif (openDialog.ShowDialog() != true)\n{\n    return \"❌ Operation cancelled\";\n}\n\n// Leer datos\nvar importedData = new List<Dictionary<string, object>>();\n\nusing (var package = new ExcelPackage(new FileInfo(openDialog.FileName)))\n{\n    var worksheet = package.Workbook.Worksheets[0];\n    \n    if (worksheet.Dimension == null)\n    {\n        return \"❌ Empty worksheet\";\n    }\n    \n    // Leer encabezados\n    var headers = new List<string>();\n    for (int col = 1; col <= worksheet.Dimension.Columns; col++)\n    {\n        headers.Add(worksheet.Cells[1, col].Value?.ToString() ?? $\"Column{col}\");\n    }\n    \n    // Leer datos\n    for (int row = 2; row <= worksheet.Dimension.Rows; row++)\n    {\n        var rowData = new Dictionary<string, object>();\n        for (int col = 1; col <= worksheet.Dimension.Columns; col++)\n        {\n            rowData[headers[col - 1]] = worksheet.Cells[row, col].Value ?? \"\";\n        }\n        importedData.Add(rowData);\n    }\n}\n\n// Mostrar resumen\nvar summary = new System.Text.StringBuilder();\nsummary.AppendLine($\"📊 Imported {importedData.Count} rows\");\nsummary.AppendLine();\nsummary.AppendLine(\"First 5 rows:\");\n\nfor (int i = 0; i < Math.Min(5, importedData.Count); i++)\n{\n    summary.AppendLine($\"\\nRow {i + 1}:\");\n    foreach (var kvp in importedData[i])\n    {\n        summary.AppendLine($\"  {kvp.Key}: {kvp.Value}\");\n    }\n}\n\nTaskDialog.Show(\"Excel Import\", summary.ToString());\n\nreturn $\"Imported {importedData.Count} rows from Excel\";",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:35:06.8667239-05:00"
    },
    {
      "Id": "csv-002",
      "Name": "Read CSV File",
      "Description": "Lee un archivo CSV y muestra su contenido",
      "Category": "📊 CSV/Excel",
      "Icon": null,
      "Code": "// Abrir diálogo para seleccionar archivo CSV\nvar openDialog = new Microsoft.Win32.OpenFileDialog\n{\n    Title = \"Select CSV File\",\n    Filter = \"CSV Files (*.csv)|*.csv|All Files (*.*)|*.*\",\n    DefaultExt = \"csv\"\n};\n\nif (openDialog.ShowDialog() != true)\n{\n    return \"❌ Operation cancelled\";\n}\n\n// Leer el archivo CSV\nvar lines = File.ReadAllLines(openDialog.FileName, Encoding.UTF8);\nvar summary = new System.Text.StringBuilder();\n\nsummary.AppendLine($\"📄 File: {Path.GetFileName(openDialog.FileName)}\");\nsummary.AppendLine($\"📊 Total rows: {lines.Length}\");\nsummary.AppendLine();\nsummary.AppendLine(\"First 10 rows:\");\nsummary.AppendLine(\"=\".PadRight(50, '='));\n\nfor (int i = 0; i < Math.Min(10, lines.Length); i++)\n{\n    summary.AppendLine(lines[i]);\n}\n\nif (lines.Length > 10)\n{\n    summary.AppendLine($\"\\n... and {lines.Length - 10} more rows\");\n}\n\nTaskDialog.Show(\"CSV Content\", summary.ToString());\n\nreturn $\"Read {lines.Length} rows from CSV\";",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:35:06.8667207-05:00"
    },
    {
      "Id": "excel-002",
      "Name": "Read Excel File",
      "Description": "Lee un archivo Excel y muestra su contenido",
      "Category": "📊 CSV/Excel",
      "Icon": null,
      "Code": "// Habilitar encodings legacy para Excel\nSystem.Text.Encoding.RegisterProvider(System.Text.CodePagesEncodingProvider.Instance);\n// Configurar licencia de EPPlus\nExcelPackage.LicenseContext = OfficeOpenXml.LicenseContext.NonCommercial;\n\n// Abrir diálogo para seleccionar archivo\nvar openDialog = new Microsoft.Win32.OpenFileDialog\n{\n    Title = \"Select Excel File\",\n    Filter = \"Excel Files (*.xlsx)|*.xlsx|All Files (*.*)|*.*\",\n    DefaultExt = \"xlsx\"\n};\n\nif (openDialog.ShowDialog() != true)\n{\n    return \"❌ Operation cancelled\";\n}\n\n// Leer el archivo Excel\nvar summary = new System.Text.StringBuilder();\n\nusing (var package = new ExcelPackage(new FileInfo(openDialog.FileName)))\n{\n    summary.AppendLine($\"📄 File: {Path.GetFileName(openDialog.FileName)}\");\n    summary.AppendLine($\"📊 Worksheets: {package.Workbook.Worksheets.Count}\");\n    summary.AppendLine();\n    \n    foreach (var worksheet in package.Workbook.Worksheets)\n    {\n        summary.AppendLine($\"Sheet: {worksheet.Name}\");\n        summary.AppendLine($\"Rows: {worksheet.Dimension?.Rows ?? 0}\");\n        summary.AppendLine($\"Columns: {worksheet.Dimension?.Columns ?? 0}\");\n        summary.AppendLine();\n        \n        // Mostrar primeras 5 filas\n        if (worksheet.Dimension != null)\n        {\n            summary.AppendLine(\"First 5 rows:\");\n            for (int row = 1; row <= Math.Min(5, worksheet.Dimension.Rows); row++)\n            {\n                var rowData = new List<string>();\n                for (int col = 1; col <= worksheet.Dimension.Columns; col++)\n                {\n                    rowData.Add(worksheet.Cells[row, col].Value?.ToString() ?? \"\");\n                }\n                summary.AppendLine(string.Join(\" | \", rowData));\n            }\n        }\n        summary.AppendLine();\n    }\n}\n\nTaskDialog.Show(\"Excel Content\", summary.ToString());\n\nreturn \"Excel file read successfully\";",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-15T00:00:00",
      "LastModified": "2025-10-15T11:35:06.8667228-05:00"
    },
    {
      "Id": "prueba-5810938177",
      "Name": "prueba",
      "Description": "",
      "Category": "Análisis",
      "Icon": "script.png",
      "Code": "// 🚀 Escribe tu código C# aquí\n// Variables disponibles:\n// - doc (Document actual)\n// - uidoc (UIDocument)\n// - app (Application)\n// - uiapp (UIApplication)\n\n// Ejemplo: Contar elementos\nint wallCount = new FilteredElementCollector(doc)\n    .OfCategory(BuiltInCategory.OST_Walls)\n    .WhereElementIsNotElementType()\n    .GetElementCount();\n\nreturn $\"Total de muros: {wallCount}\";",
      "IsFavorite": false,
      "ShowAsButton": false,
      "CreatedDate": "2025-10-14T18:16:21.0936202-05:00",
      "LastModified": "2025-10-14T18:16:21.0936202-05:00"
    },
    {
      "Id": "contador-de-puertas-4729463024",
      "Name": "Contador de puertas",
      "Description": "cuenta puertastoche",
      "Category": "Información",
      "Icon": "script.png",
      "Code": "// 🚀 Escribe tu código C# aquí\nint doorCount = new FilteredElementCollector(doc)\r\n    .OfClass(typeof(FamilyInstance))\r\n    .OfCategory(BuiltInCategory.OST_Doors)\r\n    .WhereElementIsNotElementType()\r\n    .ToElements()\r\n    .Count;\r\n\r\nTaskDialog.Show(\"Conteo\", $\"Puertas: {doorCount}\");",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-14T09:21:12.9461421-05:00",
      "LastModified": "2025-10-14T20:44:27.6500082-05:00"
    },
    {
      "Id": "contar-muros-inicial",
      "Name": "Contar Muros",
      "Description": "Cuenta el total de muros en el proyecto",
      "Category": "Información",
      "Icon": null,
      "Code": "int wallCount = new FilteredElementCollector(doc)\r\n    .OfCategory(BuiltInCategory.OST_Walls)\r\n    .WhereElementIsNotElementType()\r\n    .GetElementCount();\r\n\r\nreturn $\"Total de muros: {wallCount}\";",
      "IsFavorite": false,
      "ShowAsButton": false,
      "CreatedDate": "2025-10-14T17:20:05.0171297-05:00",
      "LastModified": "2025-10-14T17:20:05.0171297-05:00"
    },
    {
      "Id": "info-proyecto-inicial",
      "Name": "Información del Proyecto",
      "Description": "Muestra información básica del proyecto actual",
      "Category": "Información",
      "Icon": null,
      "Code": "try\r\n{\r\n    var sb = new System.Text.StringBuilder();\r\n    sb.AppendLine($\"📂 Proyecto: {doc.Title}\");\r\n    sb.AppendLine($\"📍 Ruta: {doc.PathName}\");\r\n    sb.AppendLine($\"🔧 Revit: {app.VersionName}\");\r\n    sb.AppendLine($\"📅 Fecha: {DateTime.Now:dd/MM/yyyy HH:mm}\");\r\n    return sb.ToString();\r\n}\r\ncatch (Exception ex)\r\n{\r\n    return $\"❌ Error: {ex.Message}\";\r\n}",
      "IsFavorite": false,
      "ShowAsButton": true,
      "CreatedDate": "2025-10-14T17:20:05.0171284-05:00",
      "LastModified": "2025-10-14T17:20:05.0171285-05:00"
    }
  ]
}